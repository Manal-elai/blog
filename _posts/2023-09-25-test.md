---
layout: post
title: 'testing code'
date : 2023-09-25
tags: [object detection, Yolo, Yolov2, Yolo9000]
permalink: testing-code.html
categories: 
  - Jekyll
excerpt: testing code.
katex: True
---

Hence the confidence score becomes $Pr(obj) ∗ IoU^{ truth}_{ pred}$.

 
$$
 P_r= \begin{cases}1
 & \text{if the object exist, the confidence score = IoU }  \\
 0 & \text{otherwise}  
\end{cases}
$$




$Pr(Class_i |Object) \times Pr(Object) \times IoU^{ truth}_{ pred} = Pr(Class_i ) \times IoU^{ truth}_{ pred}$


we decrease the loss of low confidence predictions by setting $$\lambda_\text{noobj} = 0.5$$.

To ensure that the confidence loss strongly upweights the loss of boxes that contain an object (i.e. Focus training on boxes containing an object), we set the following mask $1^{ obj}_{ij}$

$$\mathbb{1}_{ij}^\text{obj}= \begin{cases} 1 & \text{if } \text{ the object exists in the i-th cell and j-th box is responsible for detecting it.} \\ 0 & \text{otherwise} \end{cases} $$

Similarly to down-weight the loss for empty boxes we set the mask $1^{noobj}_{ij}$

$$\mathbb{1}_{ij}^\text{noobj}= \begin{cases}1 & \text{if } \text{ there is no object in the i-th cell } \\  0 & \text{otherwise} \end{cases} $$



* First, we define the grid cell that the top left corner of the anchor box belongs to $$(c_x, c_y)$$, the anchor is of size $$(p_w, p_h)$$.

    <br /> 
* Secondly we predict offsets to this anchor $$(t_x, t_y, t_w, t_h)$$ along with the $$t_o$$ confidence score.
    <br /> 
    
* In order to constrain the predicted box to its corresponding grid cell, we bound the box's center coordinates to the center location by using using the sigmoid function σ.
    
This final predicted box is of $$(b_x, b_y, b_w, b_h)$$ parameters :
<br /> 
<br /> 
$$
\begin{aligned} b_x &= \sigma(t_x) + c_x\\
    b_y &= \sigma(t_y) + c_y\\ b_w &= p_w e^{t_w}\\
    b_h &= p_h e^{t_h}\\
    \text{Pr}(\text{object}) &\cdot \text{IoU}(b, \text{object}) = \sigma(t_o) \end{aligned}
$$
